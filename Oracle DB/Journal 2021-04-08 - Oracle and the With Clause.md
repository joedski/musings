Journal 2021-04-08 - Oracle and the With Clause
=========

Oracle supports the With clause, but not under every circumstance that everyone else does.  Specifically, [Oracle doesn't let you do `with ... update ...` and `with ... delete ...`](https://stackoverflow.com/questions/5380559/update-statement-using-with-clause).

So,

```sql
-- With-Selects are always fine.
with Foo as (...)
select ...
from Foo
where ...
and ...
;

-- Updates don't allow this, so you can't use the same
-- with clauses in both updates and selections.
update my_app.foo Foo
set bar_id = (
    with ...
    select id
    from my_app.bar Bar
    where ...
)
where Foo.id in (
    with ...
    select id
    from ...
    where ...
    and ...
)
and ...
;

-- Deletes aren't as much of a concern, since you don't have
-- any update value calculation going on.
delete my_app.foo Foo
where Foo.id in (
    with ...
    select id
    from ...
    where ...
    and ...
)
and ...
;
```
